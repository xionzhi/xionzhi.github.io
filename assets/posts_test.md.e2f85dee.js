import{_ as s,o as a,c as n,a as l}from"./app.06916134.js";const A=JSON.parse('{"title":"test","description":"","frontmatter":{"title":"test","author":"xionzhi","date":"2022-12-20","showAccessNumber":true,"categories":["æµ‹è¯•"],"tags":["æ ‡ç­¾1","æ ‡ç­¾2","æ ‡ç­¾3"],"excerpt":""},"headers":[{"level":3,"title":"å°æ ‡é¢˜1-è¡¨å•","slug":"å°æ ‡é¢˜1-è¡¨å•","link":"#å°æ ‡é¢˜1-è¡¨å•","children":[]},{"level":3,"title":"å°æ ‡é¢˜2-Emoji","slug":"å°æ ‡é¢˜2-emoji","link":"#å°æ ‡é¢˜2-emoji","children":[]},{"level":3,"title":"å°æ ‡é¢˜3-Containers","slug":"å°æ ‡é¢˜3-containers","link":"#å°æ ‡é¢˜3-containers","children":[]},{"level":3,"title":"å°æ ‡é¢˜4-Containers","slug":"å°æ ‡é¢˜4-containers","link":"#å°æ ‡é¢˜4-containers","children":[]},{"level":3,"title":"å°æ ‡é¢˜5","slug":"å°æ ‡é¢˜5","link":"#å°æ ‡é¢˜5","children":[]},{"level":3,"title":"å°æ ‡é¢˜6","slug":"å°æ ‡é¢˜6","link":"#å°æ ‡é¢˜6","children":[]},{"level":3,"title":"å°æ ‡é¢˜7","slug":"å°æ ‡é¢˜7","link":"#å°æ ‡é¢˜7","children":[]},{"level":3,"title":"bitmapæŒ‡ä»¤è¯´æ˜","slug":"bitmapæŒ‡ä»¤è¯´æ˜","link":"#bitmapæŒ‡ä»¤è¯´æ˜","children":[]}],"relativePath":"posts/test.md"}'),p={name:"posts/test.md"},o=l(`<nav class="table-of-contents"><ul><li><a href="#å°æ ‡é¢˜1-è¡¨å•">å°æ ‡é¢˜1-è¡¨å•</a></li><li><a href="#å°æ ‡é¢˜2-emoji">å°æ ‡é¢˜2-Emoji</a></li><li><a href="#å°æ ‡é¢˜3-containers">å°æ ‡é¢˜3-Containers</a></li><li><a href="#å°æ ‡é¢˜4-containers">å°æ ‡é¢˜4-Containers</a></li><li><a href="#å°æ ‡é¢˜5">å°æ ‡é¢˜5</a></li><li><a href="#å°æ ‡é¢˜6">å°æ ‡é¢˜6</a></li><li><a href="#å°æ ‡é¢˜7">å°æ ‡é¢˜7</a></li><li><a href="#bitmapæŒ‡ä»¤è¯´æ˜">bitmapæŒ‡ä»¤è¯´æ˜</a></li></ul></nav><p><a href="https://vitepress.vuejs.org/guide/markdown" target="_blank" rel="noreferrer">vitepress.vuejs.org/guide/markdown</a></p><h3 id="å°æ ‡é¢˜1-è¡¨å•" tabindex="-1">å°æ ‡é¢˜1-è¡¨å• <a class="header-anchor" href="#å°æ ‡é¢˜1-è¡¨å•" aria-hidden="true">#</a></h3><table><thead><tr><th>Tables</th><th style="text-align:center;">Are</th><th style="text-align:right;">Cool</th></tr></thead><tbody><tr><td>col 3 is</td><td style="text-align:center;">right-aligned</td><td style="text-align:right;">$1600</td></tr><tr><td>col 2 is</td><td style="text-align:center;">centered</td><td style="text-align:right;">$12</td></tr><tr><td>zebra stripes</td><td style="text-align:center;">are neat</td><td style="text-align:right;">$1</td></tr></tbody></table><h3 id="å°æ ‡é¢˜2-emoji" tabindex="-1">å°æ ‡é¢˜2-Emoji <a class="header-anchor" href="#å°æ ‡é¢˜2-emoji" aria-hidden="true">#</a></h3><p>ğŸ‰ ğŸ’¯</p><p><a href="https://github.com/markdown-it/markdown-it-emoji/blob/master/lib/data/full.json" target="_blank" rel="noreferrer">list of all emojis</a></p><h3 id="å°æ ‡é¢˜3-containers" tabindex="-1">å°æ ‡é¢˜3-Containers <a class="header-anchor" href="#å°æ ‡é¢˜3-containers" aria-hidden="true">#</a></h3><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This is an info box.</p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This is a tip.</p></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>This is a warning.</p></div><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>This is a dangerous warning.</p></div><details class="details custom-block"><summary>Details</summary><p>This is a details block.</p></details><div class="danger custom-block"><p class="custom-block-title">STOP</p><p>Danger zone, do not proceed</p></div><h3 id="å°æ ‡é¢˜4-containers" tabindex="-1">å°æ ‡é¢˜4-Containers <a class="header-anchor" href="#å°æ ‡é¢˜4-containers" aria-hidden="true">#</a></h3><h3 id="å°æ ‡é¢˜5" tabindex="-1">å°æ ‡é¢˜5 <a class="header-anchor" href="#å°æ ‡é¢˜5" aria-hidden="true">#</a></h3><h3 id="å°æ ‡é¢˜6" tabindex="-1">å°æ ‡é¢˜6 <a class="header-anchor" href="#å°æ ‡é¢˜6" aria-hidden="true">#</a></h3><h3 id="å°æ ‡é¢˜7" tabindex="-1">å°æ ‡é¢˜7 <a class="header-anchor" href="#å°æ ‡é¢˜7" aria-hidden="true">#</a></h3><p>Redisæä¾›çš„æ•°æ®ç±»å‹ä½å›¾BitMapï¼Œæ¯ä¸ªbitä½å¯¹åº”0å’Œ1ä¸¤ä¸ªçŠ¶æ€ã€‚è™½ç„¶å†…éƒ¨è¿˜æ˜¯é‡‡ç”¨Stringç±»å‹å­˜å‚¨ï¼Œä½†Redisæä¾›äº†ä¸€äº›æŒ‡ä»¤ç”¨äºç›´æ¥æ“ä½œBitMapï¼Œå¯ä»¥æŠŠå®ƒçœ‹ä½œä¸€ä¸ªbitæ•°ç»„ï¼Œæ•°ç»„çš„ä¸‹æ ‡å°±æ˜¯åç§»é‡ã€‚</p><p>å®ƒçš„ä¼˜ç‚¹æ˜¯å†…å­˜å¼€é”€å°ï¼Œæ•ˆç‡é«˜ä¸”æ“ä½œç®€å•ï¼Œå¾ˆé€‚åˆç”¨äºç­¾åˆ°è¿™ç±»åœºæ™¯ã€‚ç¼ºç‚¹åœ¨äºä½è®¡ç®—å’Œä½è¡¨ç¤ºæ•°å€¼çš„å±€é™ã€‚å¦‚æœè¦ç”¨ä½æ¥åšä¸šåŠ¡æ•°æ®è®°å½•ï¼Œå°±ä¸è¦åœ¨æ„valueçš„å€¼ã€‚</p><h3 id="bitmapæŒ‡ä»¤è¯´æ˜" tabindex="-1">bitmapæŒ‡ä»¤è¯´æ˜ <a class="header-anchor" href="#bitmapæŒ‡ä»¤è¯´æ˜" aria-hidden="true">#</a></h3><ol><li><p>BITCOUNT</p><p>è®¡ç®—ç»™å®šå­—ç¬¦ä¸²ä¸­ï¼Œè¢«è®¾ç½®ä¸º 1 çš„æ¯”ç‰¹ä½çš„æ•°é‡</p></li><li><p>BITFIELD</p><p>åœ¨ä¸€æ¬¡è°ƒç”¨ä¸­åŒæ—¶å¯¹å¤šä¸ªä½èŒƒå›´è¿›è¡Œæ“ä½œ</p></li><li><p>BITFIELD_RO</p><p>BITFIELDçš„åªè¯»ç‰ˆæœ¬ï¼Œredis&gt;=6.0</p></li><li><p>BITOP</p><p>å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªä¿å­˜äºŒè¿›åˆ¶ä½çš„å­—ç¬¦ä¸² key è¿›è¡Œä½å…ƒæ“ä½œ</p></li><li><p>BITPOS</p><p>è¿”å›ä½å›¾ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸º bit çš„äºŒè¿›åˆ¶ä½çš„ä½ç½®</p></li><li><p>GETBIT</p><p>å¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè·å–æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)</p></li><li><p>SETBIT</p><p>å¯¹ key æ‰€å‚¨å­˜çš„å­—ç¬¦ä¸²å€¼ï¼Œè®¾ç½®æˆ–æ¸…é™¤æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)</p></li></ol><p>åŸåœ°å³ç§»ä¹‹åæœ€åä¸€ä½åˆ™æ˜¯å‰ä¸€å¤©çš„ç­¾åˆ°çŠ¶æ€</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> typing </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> t</span></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> calendar </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> monthrange</span></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> datetime </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> datetime</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> timedelta</span></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> operator </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> rshift</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> lshift</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> irshift</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> redis </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> Redis</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">UserSign</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">__init__</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">host</span><span style="color:#89DDFF;">=None,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">port</span><span style="color:#89DDFF;">=None,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">=None,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">decode_responses</span><span style="color:#89DDFF;">=None):</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;">        now: 2022-10-20</span></span>
<span class="line"><span style="color:#676E95;">        bitmap.len: 0 * 20</span></span>
<span class="line"><span style="color:#676E95;">        set 2-4 14-20</span></span>
<span class="line"><span style="color:#676E95;">        bitmap.info: 01111000000001111111 -&gt; int10(491647)</span></span>
<span class="line"><span style="color:#676E95;">        </span><span style="color:#89DDFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">host</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> host </span><span style="color:#89DDFF;">or</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">port</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> port </span><span style="color:#89DDFF;">or</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6379</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">db</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> db </span><span style="color:#89DDFF;">or</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">decode_responses</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> decode_responses </span><span style="color:#89DDFF;">or</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">True</span></span>
<span class="line"><span style="color:#A6ACCD;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">redis_store</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Redis</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">host</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">host</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                                 </span><span style="color:#A6ACCD;">port</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">port</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                                 </span><span style="color:#A6ACCD;">db</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">db</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                                 </span><span style="color:#A6ACCD;">decode_responses</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">decode_responses</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#FFCB6B;">staticmethod</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">_build_sign_key</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">uid</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">int</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">date</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> datetime</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">f</span><span style="color:#C3E88D;">&#39;u:sign:</span><span style="color:#F78C6C;">{</span><span style="color:#A6ACCD;">uid</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">{</span><span style="color:#A6ACCD;">date</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">strftime</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%Y%m</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#F78C6C;">}</span><span style="color:#C3E88D;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">do_sign</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;">self</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">uid</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">int</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">date</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> datetime</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">int</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;">        ç”¨æˆ·ç­¾åˆ°</span></span>
<span class="line"><span style="color:#676E95;">        :return ä¹‹å‰çš„ç­¾åˆ°çŠ¶æ€</span></span>
<span class="line"><span style="color:#676E95;">        </span><span style="color:#89DDFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        offset</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> date</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">day</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">return</span><span style="color:#A6ACCD;"> self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">redis_store</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setbit</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">self</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">_build_sign_key</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">uid</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> date</span><span style="color:#89DDFF;">),</span><span style="color:#82AAFF;"> offset</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">if</span><span style="color:#A6ACCD;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    us </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">UserSign</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    _uid </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">    _date </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> datetime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div>`,24),e=[o];function t(r,c,D,i,y,F){return a(),n("div",null,e)}const d=s(p,[["render",t]]);export{A as __pageData,d as default};
